# Copyright 2018 VMware, Inc.
# SPDX-License-Identifier: BSD-2-Clause OR GPL-3.0-only
---
#
# Playbook to test Security Policy
#
- hosts: localhost
  become: yes
  tasks:
    - name: create Security Policy
      nsxt_security_policy:
        hostname: "default"
        username: "default"
        password: "default"
        validate_certs: False
        id: test-sec-pol
        display_name: test-sec-pol
        state: "present"
        domain_id: "default"
        locked: True
        rules:
          - action: "ALLOW"
            description: "example-rule"
            sequence_number: 1
            display_name: "test-example-rule"
            id: "test-example-rule"
            source_groups: ["/infra/domains/vmc/groups/dbgroup"]
            destination_groups: ["/infra/domains/vmc/groups/appgroup"]
            services: ["/infra/services/HTTP", "/infra/services/CIM-HTTP"]